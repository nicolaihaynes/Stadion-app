<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Stadion App - Admin</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #eef2f7; }
    header { background: #333; color: white; padding: 15px; text-align: center; }
    .container { padding: 20px; }
    .order { background: white; padding: 15px; margin: 10px 0; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
    .status-waiting { background: #fff3cd; padding: 5px; border-radius: 3px; }
    .status-ready { background: #d4edda; padding: 5px; border-radius: 3px; }
    button { padding: 5px 10px; margin: 5px; border: none; border-radius: 5px; cursor: pointer; }
    .btn-ready { background: #28a745; color: white; }
    .btn-finish { background: #dc3545; color: white; }
  </style>
</head>
<body>
  <header>üçª Stadion App - Admin</header>
  <div class="container">
    <h3>Indkomne Ordrer</h3>
    <div id="orders"></div>
  </div>

<script>
  function renderOrders() {
    let container = document.getElementById("orders");
    container.innerHTML = "";
    for (let i = 0; i < localStorage.length; i++) {
      let key = localStorage.key(i);
      if (key.startsWith("order_")) {
        let order = JSON.parse(localStorage.getItem(key));
        if (order.status !== "Afsluttet") {
          let div = document.createElement("div");
          div.className = "order";
          div.innerHTML = "<b>ID:</b> " + order.id +
                          "<br><b>Stadion:</b> " + order.stadium +
                          "<br><b>Produkter:</b> " + order.items.map(x=>x.name).join(", ") +
                          "<br><b>Betaling:</b> " + order.payment +
                          "<br><span class='" + (order.status === "Venter" ? "status-waiting'>‚è≥ Venter" : "status-ready'>‚úÖ Klar") + "</span>" +
                          "<br><button class='btn-ready' onclick='markReady(" + order.id + ")'>Mark√©r som klar</button>" +
                          "<button class='btn-finish' onclick='finishOrder(" + order.id + ")'>Afslut</button>";
          container.appendChild(div);
        }
      }
    }
  }

  function markReady(id) {
    let order = JSON.parse(localStorage.getItem("order_" + id));
    order.status = "Klar";
    localStorage.setItem("order_" + id, JSON.stringify(order));
    renderOrders();
  }

  function finishOrder(id) {
    let order = JSON.parse(localStorage.getItem("order_" + id));
    order.status = "Afsluttet";
    localStorage.setItem("order_" + id, JSON.stringify(order));
    renderOrders();
  }

  window.addEventListener("storage", renderOrders);
  renderOrders();
</script>
</body>
</html>
